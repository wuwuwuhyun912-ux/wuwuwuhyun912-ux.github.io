<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"
    />
    <title>Mainpg (fixed)</title>
    <link rel="stylesheet" href="mainpg.css" />

    <!-- Overlay & minor overrides (ensure consistent behavior across breakpoints) -->
    <style>
      /* Ensure overlay behavior is consistent on all screen sizes */
      #overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 998;
        display: none;
        pointer-events: none; /* default: don't block clicks */
      }
      #overlay.active {
        display: block;
        pointer-events: auto; /* when active, block clicks */
        background: rgba(0, 0, 0, 0.4);
      }

      /* UX for draggable containers */
      .slide-container,
      .keyword_video {
        cursor: grab;
        -webkit-overflow-scrolling: touch;
        overflow-x: auto;
      }
      .slide-container.active,
      .keyword_video.active {
        cursor: grabbing;
      }
    </style>

    <style>
      body {
        font-family: 'Noto Sans KR', sans-serif;
        overflow-x: hidden;
      }
      * {
        margin: 0;
        padding: 0;
      }
      img {
        vertical-align: top;
      }
      ul,
      li {
        list-style: none;
      }
      a {
        text-decoration: none;
        color: black;
      }
    </style>

    <link
      href="https://fonts.googleapis.com/css2?family=Gasoek+One&amp;family=Noto+Sans+KR:wght@100..900&amp;family=Noto+Sans:ital,wght@0,100..900;1,100..900&amp;display=swap&amp;_cacheOverride=1755009814392"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="http://127.0.0.1:5500/mainpg.css?_cacheOverride=1755009814392"
    />
  </head>

  <body>
    <header>
      <a href="#" id="left_bar_btn">
        <img src="images/icons/toggle.png" alt="toggle" />
      </a>
      <a href="#" id="mobile_logo">
        <img src="images/icons/logo.png" alt="logo" />
      </a>
      <a href="#" class="mypg">
        <img src="images/icons/mypg.png" alt="mypg" />
      </a>
    </header>
    <!-- mobile header end -->
    <div id="desktopheader">
      <h1><img src="images/icons/logo.png" alt="" /></h1>
      <ul id="global_menus">
        <li>동영상 강좌</li>
        <li>플러그인</li>
        <li>커뮤니티</li>
        <li>작곡모임</li>
        <li>Radio</li>
      </ul>
      <span class="user">
        <a href="#"><img src="images/icons/profile.png" alt="프로필" /></a>
        <p>사용자의 이름 표시</p>
      </span>
    </div>

    <div id="left_bar">
      <img src="images/icons/close2.png" alt="닫기" id="close_btn" />
      <div class="profile">
        <a href="#"><img src="images/icons/profile.png" alt="프로필사진" /></a>
        <p>사용자의 이름 <br />프로필 보기</p>
      </div>
      <ul class="site_nav">
        <li><a href="mainpg.html">동영상 강좌</a></li>
        <li><a href="#">플러그인</a></li>
        <li><a href="#">커뮤니티</a></li>
        <li><a href="#">작곡모임</a></li>
        <li><a href="#">Radio</a></li>
      </ul>
      <ul class="user_service">
        <li><a href="#">구독정보</a></li>
        <li><a href="#">서비스 지원</a></li>
        <li><a href="#">로그아웃</a></li>
      </ul>
      <ul class="sns_icons">
        <li><img src="images/icons/facebook.png" alt="페이스북" /></li>
        <li><img src="images/icons/twitter.png" alt="트위터" /></li>
        <li><img src="images/icons/instagram.png" alt="인스타그램" /></li>
        <li><img src="images/icons/youtube.png" alt="유튜브" /></li>
      </ul>
    </div>

    <div id="overlay"></div>

    <div id="search">
      <button id="search-btn">
        <img src="images/icons/search.png" alt="검색" id="search-icon" />
      </button>
      <label for="search-input">검색어를 입력하세요</label>
      <input type="search" id="search-input" />
    </div>

    <div class="banner">
      <a href="#"><img src="images/banner1.jpg" alt="#" id="banner-img" /></a>
    </div>

    <div id="background">
      <div id="contents_wrap">
        <!-- tabs and contents (kept original structure) -->
        <input type="radio" name="tab" id="tab1" checked />
        <input type="radio" name="tab" id="tab2" />
        <input type="radio" name="tab" id="tab3" />
        <input type="radio" name="tab" id="tab4" />

        <div class="tabs-container">
          <ul id="tabs" class="active">
            <li class="tabMenu"><label for="tab1">Full Video</label></li>
            <li class="tabMenu"><label for="tab2">Shorts</label></li>
            <li class="tabMenu"><label for="tab3">장르별 보기</label></li>
            <li class="tabMenu"><label for="tab4">프리미엄 비디오</label></li>
          </ul>
        </div>

        <div class="contents">
          <section class="full_video content" id="content1">
            <h1>Full Video</h1>
            <h2>인기 영상</h2>
            <article class="popular-video">
              <div class="slide-container">
                <div class="slidecontents">
                  <a class="thumbnail" href="videopg.html">
                    <img src="images/Video_popular1.jpg" alt="ㅇㅇ" />
                    <h4>룸 어쿠스틱을 <br />위한 작업실</h4>
                    <p>The Quiett</p>
                    <p class="slidecontents-footer">마스터링</p>
                  </a>
                </div>
                <div class="slidecontents">
                  <a href="#" class="thumbnail">
                    <img src="images/Video_popular2.jpg" alt="ㅇㅇ" />
                    <h4>Drill 장르의 <br />808 bass 세팅</h4>
                    <p>Paul Blanco</p>
                    <p class="slidecontents-footer">Drill</p>
                  </a>
                </div>
                <div class="slidecontents">
                  <a href="#" class="thumbnail">
                    <img src="images/Video_popular3.jpg" alt="ㅇㅇ" />
                    <h4>ATL trap <br />사운드 메이킹</h4>
                    <p>Lean $moke</p>
                    <p class="slidecontents-footer">Trap</p>
                  </a>
                </div>
              </div>
            </article>

            <!-- other sections kept as in original file -->
          </section>
        </div>
      </div>
    </div>

    <footer>
      <ul>
        <li>
          <a href="#"><img src="images/icons/Home.png" alt="home" /></a>
        </li>
        <li>
          <a href="#"><img src="images/icons/likes.png" alt="likes" /></a>
        </li>
        <li>
          <a href="#"><img src="images/icons/recent.png" alt="recent" /></a>
        </li>
        <li>
          <a href="#"><img src="images/icons/cart.png" alt="cart" /></a>
        </li>
      </ul>
    </footer>

    <!-- Modals (kept) -->
    <div id="modal" class="modal">
      <div class="modal-content">
        <span class="close-btn">×</span>
        <p id="modal-text"></p>
      </div>
    </div>

    <div id="modal_descktop" class="modal">
      <div class="modal-content">
        <span class="close-btn_descktop">×</span>
        <p id="modal-text_descktop"></p>
      </div>
    </div>

    <!-- ======= REPLACED / CONSOLIDATED SCRIPT ======= -->
    <script>
      (function () {
        'use strict';

        function init() {
          // Attach drag-scroll to containers
          document
            .querySelectorAll('.slide-container, .keyword_video')
            .forEach(makeDragScroll);

          // left-bar / overlay toggle (always bound)
          const left_bar_btn = document.getElementById('left_bar_btn');
          const left_bar = document.getElementById('left_bar');
          const overlay = document.getElementById('overlay');
          const close_btn = document.getElementById('close_btn');

          if (left_bar_btn && left_bar && overlay && close_btn) {
            left_bar_btn.addEventListener('click', () => {
              left_bar.classList.toggle('active');
              overlay.classList.toggle('active');
            });
            close_btn.addEventListener('click', () => {
              left_bar.classList.remove('active');
              overlay.classList.remove('active');
            });
            overlay.addEventListener('click', () => {
              left_bar.classList.remove('active');
              overlay.classList.remove('active');
            });
          }

          // search toggle
          (function () {
            const btn = document.getElementById('search-btn');
            const input = document.getElementById('search-input');
            const icon = document.getElementById('search-icon');
            if (!btn || !input || !icon) return;
            let isVisible = false;
            btn.addEventListener('click', () => {
              if (!isVisible) {
                input.style.width = '83.4vw';
                input.style.opacity = '1';
                input.style.transform = 'translateX(0)';
                icon.src = 'images/icons/close.jpg';
              } else {
                input.style.width = '0';
                input.style.opacity = '0';
                input.style.transform = 'translateX(-2.78px)';
                icon.src = 'images/icons/search.png';
              }
              isVisible = !isVisible;
            });
          })();

          // banner rotation
          (function () {
            const bannerImg = document.getElementById('banner-img');
            if (!bannerImg) return;
            let current = 1;
            const total = 3;
            setInterval(() => {
              current++;
              if (current > total) current = 1;
              bannerImg.src = `images/banner${current}.jpg`;
            }, 6000);
          })();

          // modal descriptions
          (function () {
            const descriptions = document.querySelectorAll('.description2');
            if (!descriptions || descriptions.length === 0) return;
            let modal, modalText, closeBtn;
            function setModalElements() {
              if (window.innerWidth >= 1024) {
                modal = document.getElementById('modal_descktop');
                modalText = document.getElementById('modal-text_descktop');
                closeBtn = modal
                  ? modal.querySelector('.close-btn_descktop')
                  : null;
              } else {
                modal = document.getElementById('modal');
                modalText = document.getElementById('modal-text');
                closeBtn = modal ? modal.querySelector('.close-btn') : null;
              }
            }
            setModalElements();
            window.addEventListener('resize', setModalElements);
            descriptions.forEach((desc) => {
              desc.addEventListener('click', function () {
                const fullText = this.textContent || '';
                if (modalText) modalText.textContent = fullText;
                if (modal) modal.style.display = 'block';
              });
            });
            document.addEventListener('click', function (e) {
              if (e.target === closeBtn && modal) {
                modal.style.display = 'none';
              }
            });
            window.addEventListener('click', function (event) {
              if (event.target === modal) {
                modal.style.display = 'none';
              }
            });
          })();
        }

        // makeDragScroll: safer, non-capturing click suppression only directly after drag
        function makeDragScroll(container) {
          if (!container) return;
          let pointerDown = false;
          let startX = 0,
            startY = 0,
            startScrollLeft = 0;
          let isDragging = false;
          let lastSuppressTime = 0;
          const THRESHOLD = 8;

          container.addEventListener('dragstart', (e) => e.preventDefault());

          container.addEventListener('pointerdown', (e) => {
            if (e.pointerType === 'mouse' && e.button !== 0) return;
            pointerDown = true;
            isDragging = false;
            startX = e.clientX;
            startY = e.clientY;
            startScrollLeft = container.scrollLeft;
            try {
              container.setPointerCapture?.(e.pointerId);
            } catch (_) {}
          });

          container.addEventListener('pointermove', (e) => {
            if (!pointerDown) return;
            const dx = e.clientX - startX;
            const dy = e.clientY - startY;
            if (
              !isDragging &&
              (Math.abs(dx) > THRESHOLD || Math.abs(dy) > THRESHOLD)
            ) {
              isDragging = true;
            }
            if (isDragging) {
              container.scrollLeft = startScrollLeft - dx;
            }
          });

          const endPointer = (e) => {
            if (isDragging) lastSuppressTime = Date.now();
            pointerDown = false;
            isDragging = false;
            try {
              container.releasePointerCapture?.(e.pointerId);
            } catch (_) {}
          };

          container.addEventListener('pointerup', endPointer);
          container.addEventListener('pointercancel', endPointer);
          container.addEventListener('pointerleave', endPointer);

          container.addEventListener(
            'click',
            (e) => {
              if (Date.now() - lastSuppressTime < 250) {
                const a =
                  e.target && e.target.closest
                    ? e.target.closest('a[href]')
                    : null;
                if (a) {
                  e.preventDefault();
                  e.stopImmediatePropagation();
                }
              }
            },
            false
          );
        }

        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', init);
        } else {
          init();
        }
      })();
    </script>
  </body>
</html>
